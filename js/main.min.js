Generator={canvas:void 0,ctx:void 0,lat:void 0,lon:void 0,place:void 0,width:1e3,height:1e3,deg:-0.6*Math.random()+.3,init:function(){var t=this;t.canvas=document.getElementById("generator"),t.ctx=t.canvas.getContext("2d"),t.getLocation()},getLocation:function(){var t=this;$.ajax({url:"unesco.json",dataType:"json",type:"GET",error:function(t,o,e){console.log("jqXHR",t),console.log("textStatus",o),console.log("errorThrown",e)},success:function(o){var e=o.QUERYRESULT.DATA,a=Math.floor(Math.random()*(e.length+1));t.lat=e[a][0],t.lon=e[a][1],t.place=e[a][5],t.getFlickr()}})},getFlickr:function(){var t=this;$.ajax({url:"https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=731a3dc1069a15969d725a3805acc530&lat="+t.lat+"&lon="+t.lon+"&extras=url_l&format=json&jsoncallback=?",dataType:"jsonp",type:"GET",error:function(t,o,e){console.log("jqXHR",t),console.log("textStatus",o),console.log("errorThrown",e)},success:function(o){console.log("Flickr Response",o),t.loadFlickrImage(o)}})},loadFlickrImage:function(t){var o=this,e=t.photos.photo;if("undefined"!==e){var a=Math.floor(Math.random()*(e.length+1)),n=e[a].url_l;o.urlToData(n,function(t){o.drawBackground(t)})}else o.getFlickr()},drawBackground:function(t){var o=this,e=new Image;e.onload=function(){var t,a,n=e.naturalHeight,r=e.naturalWidth;n===r?(t=o.height/n,o.ctx.drawImage(e,0,0,r*t,n*t)):n>r?(t=o.width/r,a=(n*t-o.height)/2,o.ctx.drawImage(e,0,-a,r*t,n*t)):(t=o.height/n,a=(r*t-o.width)/2,o.ctx.drawImage(e,-a,0,r*t,n*t)),o.drawGlobie(o.deg)},e.src=t},drawGlobie:function(){var t=this,o=document.getElementById("globie");t.ctx.rotate(t.deg),t.ctx.drawImage(o,0,500,850,850),$("#caption").html("Globie visits "+t.place),t.saveImage()},saveImage:function(){var t=this,o=t.canvas.toDataURL("image/png");document.getElementById("output").src=o},urlToData:function(t,o,e){var a=new Image;a.crossOrigin="Anonymous",a.onload=function(){var t,a=document.createElement("CANVAS"),n=a.getContext("2d");a.height=this.height,a.width=this.width,n.drawImage(this,0,0),t=a.toDataURL(e),o(t),a=null},a.src=t}},jQuery(document).ready(function(){"use strict";Generator.init()});
//# sourceMappingURL=/main.min.js.map